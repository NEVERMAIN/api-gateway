<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="io.github.NEVERMAIN.gateway.center.infrastructure.dao.IApplicationSystemDao">


    <resultMap id="ApplicationSystemMap" type="io.github.NEVERMAIN.gateway.center.infrastructure.dao.po.ApplicationSystem">
        <id column="id" property="id"/>
        <id column="system_id" property="systemId"/>
        <id column="system_name" property="systemName"/>
        <id column="system_registry" property="systemRegistry"/>
        <id column="system_address" property="systemAddress"/>
        <id column="create_time" property="createTime"/>
        <id column="update_time" property="updateTime"/>
    </resultMap>

    <insert id="insert">
        insert into application_system(system_id, system_name, system_registry,system_address, create_time, update_time)
        values (#{systemId}, #{systemName}, #{systemRegistry}, #{systemAddress} , now(), now())
    </insert>

    <update id="update" parameterType="io.github.NEVERMAIN.gateway.center.infrastructure.dao.po.ApplicationSystem">
        UPDATE application_system
        SET system_name     = #{systemName},
            system_registry = #{systemRegistry},
            system_address  = #{systemAddress},
            update_time     = now()
        WHERE system_id = #{systemId}
    </update>

    <select id="queryApplicationSystemList"
            resultMap="ApplicationSystemMap">
        SELECT system_id, system_name , system_registry, system_address
        FROM application_system
        WHERE system_id IN
        <foreach collection="systemIdList" index="idx" item="item" open="(" close=")" separator=",">
            #{item}
        </foreach>
    </select>

    <select id="queryApplicationSystemListByPage"
            parameterType="io.github.NEVERMAIN.gateway.center.types.common.OperationRequest"
            resultMap="ApplicationSystemMap">
        SELECT id, system_id, system_name , system_registry, system_address, create_time, update_time
        FROM application_system
        <where>
            <if test="data != null and data.systemId != '' ">
                AND system_id = #{data.systemId}
            </if>
            <if test="data != null and data.systemName != '' ">
                AND system_name = #{data.systemName}
            </if>
        </where>
        ORDER BY id DESC
        limit #{pageStart}, #{pageEnd}
    </select>

    <select id="queryApplicationSystemCountByPage"
            parameterType="io.github.NEVERMAIN.gateway.center.types.common.OperationRequest"
            resultType="java.lang.Integer">
        SELECT COUNT(id)
        FROM application_system
        <where>
            <if test="data != null and data.systemId != '' ">
                AND system_id = #{data.systemId}
            </if>
            <if test="data != null and data.systemName != '' ">
                AND system_name = #{data.systemName}
            </if>
        </where>
    </select>

    <select id="queryApplicationSystemBySystemId"
            resultMap="ApplicationSystemMap">
        SELECT system_id, system_name, system_registry, system_address
        FROM application_system
        WHERE system_id = #{systemId}
    </select>


</mapper>
